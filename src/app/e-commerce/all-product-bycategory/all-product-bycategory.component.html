<app-top-contact-info></app-top-contact-info>
<app-home-banner></app-home-banner>
<div class="grid p-0 m-0" style="width: 100%;">
    <div class="col-12 product-title" style="width: 100%;">
        <h2 class="mb-0 text-center">{{categoryName?? ''}}</h2>
    </div>
    <div class="p-fluid product-container" style="width: 100%;">
        <div class="grid p-0 m-0" style="width: 100%;">
            <div class="col-3">
                <h3>Filters</h3>
                <div class="show-desktop-collection">
                    <div class="collection-slider mt-3">
                        <p-accordion [activeIndex]="0">
                            <p-accordionTab header="Collection" class="accordion-menu">
                                <ul>
                                    <li *ngFor="let x of categories">
                                        <a *ngIf="x.id" routerLink="/products/{{x.name}}/{{x.id}}"
                                            routerLinkActive="active-link" class="block flex items-center menu-link">
                                            {{x.name?? ''}}
                                        </a>
                                        <a *ngIf="!x.id" routerLink="{{x.routerLink}}" routerLinkActive="active-link"
                                            class="block flex items-center menu-link">
                                            {{x.name?? ''}}
                                        </a>
                                    </li>
                                </ul>
                            </p-accordionTab>
                        </p-accordion>
                        <p-accordion [activeIndex]="0">
                            <p-accordionTab header="Availability" class="availabilty">
                                <div class="stock-in mb-3 flex p-2">
                                    <p-checkbox [binary]="true"></p-checkbox>
                                    <label class="ml-2">In Stock</label>
                                </div>
                                <div class="stock-in flex p-2">
                                    <p-checkbox [disabled]="true" [binary]="true"></p-checkbox>
                                    <label class="ml-2 text-grey-500">Out of Stock (0)</label>
                                </div>
                            </p-accordionTab>
                        </p-accordion>
                        <p-accordion [activeIndex]="0">
                            <p-accordionTab header="Price" class="slider-price-range">
                                <div class="price-range-container">
                                    <!-- Slider -->
                                    <p-slider [(ngModel)]="priceRange" [range]="true" [min]="0" [max]="5000">
                                    </p-slider>

                                    <!-- Min/Max Inputs -->
                                    <div class="price-inputs mt-3">
                                        <input type="number" [value]="priceRange[0]" [min]="0" [max]="priceRange[1]"
                                            (ngModelChange)="onMinInputChange($event)" [(ngModel)]="minInput" />
                                        <span> To </span>
                                        <input type="number" [value]="priceRange[1]" [min]="priceRange[0]" [max]="5000"
                                            (ngModelChange)="onMaxInputChange($event)" [(ngModel)]="maxInput" />
                                    </div>
                                </div>
                            </p-accordionTab>
                        </p-accordion>
                    </div>
                </div>
            </div>
            <div class="col-9 p-0 m-0">
                <div class="grid p-0 m-0" style="width: 100%;">
                    <div class="col-12 m-0" style="width: 100%;">
                        <div class="grid p-0 m-0" style="width: 100%;">
                            <div class="col-6 pl-3 mb-0 pb-0 featured-filter-btn">
                                <p-menu class="filter-menu" #featureOption [popup]="true" [model]=GetFeaturedOptions()>
                                </p-menu>
                                <button pButton pRipple icon="pi pi-chevron-down" label="{{this.selectedFeature}}"
                                    style="width:fit-content;" (click)="featureOption.toggle($event)"
                                    class="p-button-text p-button-success">
                                </button>
                            </div>
                            <div class="col-6 text-right ml-auto mb-0 pb-0 featured-btn">
                                <button pTooltip="List" tooltipPosition="top" pButton pRipple icon="pi pi-bars"
                                    class="p-button-success p-button-outlined mb-2"
                                    [ngClass]="{ 'selected-layout': selectedLayout === 'list' }"
                                    (click)="setLayout('list')" style="width: fit-content;">
                                </button>

                                <button pTooltip="2 Columns" tooltipPosition="top" pButton pRipple label="||"
                                    class="p-button-success p-button-outlined ml-2 mb-2"
                                    [ngClass]="{ 'selected-layout': selectedLayout === '||' }" (click)="setLayout('||')"
                                    style="width: fit-content;">
                                </button>

                                <button pTooltip="3 Columns" tooltipPosition="top" pButton pRipple label="|||"
                                    class="p-button-success p-button-outlined ml-2 mb-2"
                                    [ngClass]="{ 'selected-layout': selectedLayout === '|||' }"
                                    (click)="setLayout('|||')" style="width: fit-content;">
                                </button>

                                <button pTooltip="4 Columns" tooltipPosition="top" pButton pRipple label="||||"
                                    class="p-button-success p-button-outlined ml-2 mb-2"
                                    [ngClass]="{ 'selected-layout': selectedLayout === '||||' }"
                                    (click)="setLayout('||||')" style="width: fit-content;">
                                </button>

                                <button pTooltip="5 Columns" tooltipPosition="top" pButton pRipple label="|||||"
                                    class="p-button-success p-button-outlined ml-2 mb-2"
                                    [ngClass]="{ 'selected-layout': selectedLayout === '|||||' }"
                                    (click)="setLayout('|||||')" style="width: fit-content;">
                                </button>
                            </div>
                        </div>
                    </div>
                    <ng-container *ngIf="viewMode === 'grid'">
                        <div class="col-3 product-col" *ngFor="let product of productList" [ngClass]="{
                                'col-6': selectedLayout === '||',
                                'col-4': selectedLayout === '|||',
                                'col-3': selectedLayout === '||||',
                                'col-2': selectedLayout === '|||||' 
                              }">
                            <div class="card h-full flex flex-column shadow-2 product-card">
                                <a routerLink="/product-detail/{{product.id}}">
                                    <div class="image-wrapper">
                                        <img draggable="false" *ngIf="product.productImageUrl"
                                            src="{{baseUrl}}/{{ product.productImageUrl }}" alt="{{ product.name }}">
                                        <img draggable="false" *ngIf="!product.productImageUrl"
                                            src="assets/images/default-img.png" alt="{{ product.name }}">
                                        <span *ngIf="product.discount > 0" class="product-discount">On Sale</span>
                                    </div>
                                </a>

                                <div class="p-3 flex flex-column justify-between flex-grow-1">
                                    <div class="align-items-center text-center">
                                        <h3 class="text-lg font-semibold m-0">
                                            {{ product.name }}
                                            <span *ngIf="product?.description">- ({{ product?.description?? ''
                                                }})</span>
                                        </h3>
                                        <p *ngIf="!product.discount" class="text-gray-600 mt-1">৳ {{
                                            product.sellingPrice |
                                            number:"1.2-2" }}</p>
                                        <p *ngIf="product.discount" class="text-gray-600 mt-1">
                                            <span>৳ {{ onCalculateDiscountedPrice(product.sellingPrice,
                                                product.discount) |
                                                number:"1.2-2" }}</span>
                                            <span style="text-decoration: line-through;padding-left:15px;">৳ {{
                                                product.sellingPrice |
                                                number:"1.2-2" }}</span>
                                        </p>
                                        <p class="mb-2">
                                            <p-badge value="{{product?.isStockAvailable? 'Available':'Stock Out'}}"
                                                severity="{{product?.isStockAvailable? 'success':'danger'}}"></p-badge>
                                        </p>
                                    </div>
                                    <div class="mt-auto ml-auto mr-auto">       
                                        <div class="flex align-items-center">
                                            <div class="flex items-center"
                                                style="background-color:#eae9e9; border:1px solid grey;">
                                                <button pButton icon="pi pi-minus"
                                                    class="p-button-sm p-button-primary p-button-text"
                                                    (click)="decreaseQty(product)"></button>
                                                <div class="align-items-center justify-content-center p-1"
                                                    style="border-left:1px solid grey; border-right:1px solid grey;">
                                                    <span class="px-3"> {{ getCartQty(product.productDetailId) }}</span>
                                                </div>
                                                <button pButton icon="pi pi-plus"
                                                    class="p-button-sm p-button-primary p-button-text"
                                                    (click)="increaseQty(product)"></button>
                                            </div>
                                            <!-- <button pButton icon="pi pi-trash" class="p-button-danger ml-2 p-button-outlined" (click)="onRemoveItem(i)">
                                                                </button> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12" *ngIf="productList?.length == 0">
                            <h4 class="text-center">No Items Available</h4>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="viewMode === 'list'">
                        <div *ngFor="let product of productList" class="col-12 mb-3">
                            <div class="card shadow-2 p-3">
                                <div class="grid align-items-center">

                                    <!-- IMAGE -->
                                    <div class="col-3 text-center">
                                        <img [src]="product?.productImageUrl ? baseUrl + '/' + product?.productImageUrl : 'assets/images/default-img.png'"
                                            alt="{{product?.name}}"
                                            style="max-width: 100%; height: 200px; object-fit: contain;">
                                    </div>

                                    <!-- INFO -->
                                    <div class="col-9">
                                        <h4 class="text-2xl font-bold m-0">
                                            {{ product.name }}
                                            <span *ngIf="product?.description">- ({{ product?.description?? ''
                                                }})</span>
                                        </h4>

                                        <!-- Price -->
                                        <p style="font-size: 16px;" *ngIf="!product.discount"
                                            class="text-gray-600 mt-1">
                                            ৳ {{ product.sellingPrice | number:"1.2-2" }}
                                        </p>

                                        <p style="font-size: 16px;" *ngIf="product.discount" class="text-gray-600 mt-1">
                                            <span>৳ {{ onCalculateDiscountedPrice(product.sellingPrice,
                                                product.discount) | number:"1.2-2"
                                                }}</span>
                                            <span style="text-decoration: line-through; padding-left:15px;">
                                                ৳ {{ product.sellingPrice | number:"1.2-2" }}
                                            </span>
                                        </p>

                                        <!-- Extra Info -->
                                        <p *ngIf="product?.description" style="font-size: 16px;"
                                            class="text-gray-500 mb-2">Size: {{ product.description }}</p>

                                        <p class="mb-2">
                                            <p-badge value="{{product?.isStockAvailable? 'Available':'Stock Out'}}"
                                                severity="{{product?.isStockAvailable? 'success':'danger'}}"></p-badge>
                                        </p>
                                        
                                        <div class="mt-auto ml-auto mr-auto">
                                            <div class="flex align-items-center">
                                                <div class="flex items-center"
                                                    style="background-color:#eae9e9; border:1px solid grey;">
                                                    <button pButton icon="pi pi-minus"
                                                        class="p-button-sm p-button-primary p-button-text"
                                                        (click)="decreaseQty(product)"></button>
                                                    <div class="align-items-center justify-content-center p-1"
                                                        style="border-left:1px solid grey; border-right:1px solid grey;">
                                                        <span class="px-3"> {{ getCartQty(product.productDetailId)
                                                            }}</span>
                                                    </div>
                                                    <button pButton icon="pi pi-plus"
                                                        class="p-button-sm p-button-primary p-button-text"
                                                        (click)="increaseQty(product)"></button>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12" *ngIf="productList?.length == 0">
                            <h4 class="text-center">No Items Available</h4>
                        </div>
                    </ng-container>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- <app-home-footer></app-home-footer> -->